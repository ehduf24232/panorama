{"ast":null,"code":"import React,{useState}from'react';import{Container,Box,Typography,Button,Paper,Snackbar,Alert}from'@mui/material';import DownloadIcon from'@mui/icons-material/Download';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AdminPage(){const[snackbar,setSnackbar]=useState({open:false,message:'',severity:'success'});const handleExportExcel=async()=>{try{console.log('엑셀 다운로드 요청');const response=await fetch('http://localhost:5000/api/consultations/export-excel');if(response.ok){const blob=await response.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='consultations.xlsx';document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);setSnackbar({open:true,message:'엑셀 파일이 성공적으로 다운로드되었습니다.',severity:'success'});}else{const errorData=await response.json();throw new Error(errorData.message||'엑셀 파일 생성 중 오류가 발생했습니다.');}}catch(error){console.error('엑셀 다운로드 오류:',error);setSnackbar({open:true,message:error.message||'엑셀 파일 다운로드 중 오류가 발생했습니다.',severity:'error'});}};const handleCloseSnackbar=()=>{setSnackbar({...snackbar,open:false});};return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",children:[/*#__PURE__*/_jsxs(Box,{sx:{my:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h3\",component:\"h1\",gutterBottom:true,align:\"center\",children:\"\\uAD00\\uB9AC\\uC790 \\uD398\\uC774\\uC9C0\"}),/*#__PURE__*/_jsx(Paper,{elevation:3,sx:{p:4},children:/*#__PURE__*/_jsx(Box,{sx:{textAlign:'center'},children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",startIcon:/*#__PURE__*/_jsx(DownloadIcon,{}),onClick:handleExportExcel,size:\"large\",children:\"\\uC0C1\\uB2F4 \\uC2E0\\uCCAD \\uBAA9\\uB85D \\uC5D1\\uC140 \\uB2E4\\uC6B4\\uB85C\\uB4DC\"})})})]}),/*#__PURE__*/_jsx(Snackbar,{open:snackbar.open,autoHideDuration:6000,onClose:handleCloseSnackbar,children:/*#__PURE__*/_jsx(Alert,{onClose:handleCloseSnackbar,severity:snackbar.severity,children:snackbar.message})})]});}export default AdminPage;","map":{"version":3,"names":["React","useState","Container","Box","Typography","Button","Paper","Snackbar","Alert","DownloadIcon","jsx","_jsx","jsxs","_jsxs","AdminPage","snackbar","setSnackbar","open","message","severity","handleExportExcel","console","log","response","fetch","ok","blob","url","window","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","revokeObjectURL","removeChild","errorData","json","Error","error","handleCloseSnackbar","maxWidth","children","sx","my","variant","component","gutterBottom","align","elevation","p","textAlign","color","startIcon","onClick","size","autoHideDuration","onClose"],"sources":["C:/Users/DL/panorama/instagram/src/AdminPage.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport {\r\n  Container,\r\n  Box,\r\n  Typography,\r\n  Button,\r\n  Paper,\r\n  Snackbar,\r\n  Alert,\r\n} from '@mui/material';\r\nimport DownloadIcon from '@mui/icons-material/Download';\r\n\r\nfunction AdminPage() {\r\n  const [snackbar, setSnackbar] = useState({\r\n    open: false,\r\n    message: '',\r\n    severity: 'success',\r\n  });\r\n\r\n  const handleExportExcel = async () => {\r\n    try {\r\n      console.log('엑셀 다운로드 요청');\r\n      const response = await fetch('http://localhost:5000/api/consultations/export-excel');\r\n      \r\n      if (response.ok) {\r\n        const blob = await response.blob();\r\n        const url = window.URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = 'consultations.xlsx';\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        window.URL.revokeObjectURL(url);\r\n        document.body.removeChild(a);\r\n\r\n        setSnackbar({\r\n          open: true,\r\n          message: '엑셀 파일이 성공적으로 다운로드되었습니다.',\r\n          severity: 'success',\r\n        });\r\n      } else {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.message || '엑셀 파일 생성 중 오류가 발생했습니다.');\r\n      }\r\n    } catch (error) {\r\n      console.error('엑셀 다운로드 오류:', error);\r\n      setSnackbar({\r\n        open: true,\r\n        message: error.message || '엑셀 파일 다운로드 중 오류가 발생했습니다.',\r\n        severity: 'error',\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleCloseSnackbar = () => {\r\n    setSnackbar({ ...snackbar, open: false });\r\n  };\r\n\r\n  return (\r\n    <Container maxWidth=\"md\">\r\n      <Box sx={{ my: 4 }}>\r\n        <Typography variant=\"h3\" component=\"h1\" gutterBottom align=\"center\">\r\n          관리자 페이지\r\n        </Typography>\r\n        <Paper elevation={3} sx={{ p: 4 }}>\r\n          <Box sx={{ textAlign: 'center' }}>\r\n            <Button\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              startIcon={<DownloadIcon />}\r\n              onClick={handleExportExcel}\r\n              size=\"large\"\r\n            >\r\n              상담 신청 목록 엑셀 다운로드\r\n            </Button>\r\n          </Box>\r\n        </Paper>\r\n      </Box>\r\n      <Snackbar\r\n        open={snackbar.open}\r\n        autoHideDuration={6000}\r\n        onClose={handleCloseSnackbar}\r\n      >\r\n        <Alert onClose={handleCloseSnackbar} severity={snackbar.severity}>\r\n          {snackbar.message}\r\n        </Alert>\r\n      </Snackbar>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default AdminPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}